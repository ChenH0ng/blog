{"version":3,"sources":["../../src/db/index.js"],"names":["URL","mongodb","require","ObjectID","context","module","exports","cb","client","MongoClient","connect","err","db","console","log","handleClose","e","close","process","exit","on","ID","id","Post","Rest","Session"],"mappings":";;AAAA,IAAMA,MAAM,gCAAZ;AACA,IAAMC,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,WAAWF,QAAQE,QAAzB;AACA,IAAMC,UAAUF,QAAQ,WAAR,CAAhB;AACAG,OAAOC,OAAP,GAAiB,UAAUC,EAAV,EAAc;AAC3B,QAAMC,SAASP,QAAQQ,WAAvB;AACAD,WAAOE,OAAP,CAAeV,GAAf,EAAoB,UAAUW,GAAV,EAAeC,EAAf,EAAmB;AACnC,YAAID,GAAJ,EAAQE,QAAQC,GAAR,CAAYH,GAAZ;AACR,YAAMI,cAAc,SAAdA,WAAc,CAACC,CAAD,EAAO;AACvBJ,eAAGK,KAAH,CAAS,YAAM;AACXJ,wBAAQC,GAAR,CAAYE,CAAZ;AACAE,wBAAQC,IAAR,CAAa,CAAb;AACH,aAHD;AAIH,SALD;AAMAD,gBAAQE,EAAR,CAAW,QAAX,EAAqBL,WAArB;AACAG,gBAAQE,EAAR,CAAW,mBAAX,EAAgCL,WAAhC;AACAX,gBAAQQ,EAAR,GAAaA,EAAb;AACAL,WAAG;AACCc,gBAAI;AAAA,uBAAM,IAAIlB,QAAJ,CAAamB,EAAb,CAAN;AAAA,aADL;AAECC,kBAAMrB,QAAQ,UAAR,EAAoBqB,IAF3B;AAGCC,kBAAMtB,QAAQ,QAAR,CAHP;AAICuB,qBAASvB,QAAQ,WAAR;AAJV,SAAH;AAMH,KAjBD;AAkBH,CApBD","file":"index.js","sourcesContent":["const URL = 'mongodb://localhost:27017/blog';\r\nconst mongodb = require('mongodb');\r\nconst ObjectID = mongodb.ObjectID;\r\nconst context = require('./context');\r\nmodule.exports = function (cb) {\r\n    const client = mongodb.MongoClient;\r\n    client.connect(URL, function (err, db) {\r\n        if (err)console.log(err);\r\n        const handleClose = (e) => {\r\n            db.close(() => {\r\n                console.log(e);\r\n                process.exit(0);\r\n            });\r\n        };\r\n        process.on('SIGINT', handleClose);\r\n        process.on('uncaughtException', handleClose);\r\n        context.db = db;\r\n        cb({\r\n            ID: id => new ObjectID(id),\r\n            Post: require('./Models').Post,\r\n            Rest: require('./Rest'),\r\n            Session: require('./Session'),\r\n        });\r\n    });\r\n};"]}