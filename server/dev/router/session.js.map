{"version":3,"sources":["../../src/router/session.js"],"names":["module","exports","Router","Session","session","maxAge","store","router","route","post","req","res","next","create","body","then","user","cookie","expires","Date","now","json","ce","da","get","delete","destroy","sessionID"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,gBAAuC;AAAA,KAA5BC,MAA4B,QAA5BA,MAA4B;AAAA,KAApBC,OAAoB,QAApBA,OAAoB;AAAA,KAAXC,OAAW,QAAXA,OAAW;AAAA,KAChDC,MADgD,GACjCD,OADiC,CAChDC,MADgD;AAAA,KACxCC,KADwC,GACjCF,OADiC,CACxCE,KADwC;;AAEvD,KAAMC,SAAUL,QAAhB;AACAK,QAAOC,KAAP,CAAa,GAAb,EACEC,IADF,CACO,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzBT,UAAQU,MAAR,CAAeH,IAAII,IAAnB,EACEC,IADF,CACO,gBAAQ;AACb,OAAIC,IAAJ,EAAU;AACTN,QAAIN,OAAJ,CAAYa,MAAZ,CAAmBC,OAAnB,GAA6B,IAAIC,IAAJ,CAASA,KAAKC,GAAL,KAAaf,MAAtB,CAA7B;AACAK,QAAIN,OAAJ,CAAYY,IAAZ,GAAmBA,IAAnB;AACAL,QAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAUC,IAAIP,IAAd,EAAT;AACA,IAJD,MAMCL,IAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAT;AACD,GATF;AAUA,EAZF,EAaEE,GAbF,CAaM,UAACd,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,MAAIF,IAAIN,OAAJ,CAAYY,IAAhB,EAAsB;AACrBN,OAAIN,OAAJ,CAAYa,MAAZ,CAAmBC,OAAnB,GAA6B,IAAIC,IAAJ,CAASA,KAAKC,GAAL,KAAaf,MAAtB,CAA7B;AACAM,OAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAUC,IAAIb,IAAIN,OAAJ,CAAYY,IAA1B,EAAT;AACA,GAHD,MAKCL,IAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAT;AACD,EApBF,EAqBEG,MArBF,CAqBS,UAACf,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3B,MAAIF,IAAIN,OAAJ,CAAYY,IAAhB,EAAsB;AACrBV,SAAMoB,OAAN,CAAchB,IAAIiB,SAAlB,EAA6B;AAAA,WAAMhB,IAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAT,CAAN;AAAA,IAA7B;AACA,GAFD,MAICX,IAAIU,IAAJ,CAAS,EAACC,IAAI,GAAL,EAAT;AACD,EA3BF;AA4BA,QAAOf,MAAP;AACA,CAhCD","file":"session.js","sourcesContent":["module.exports = function ({Router, Session, session,}) {\r\n\tconst {maxAge, store}=session;\r\n\tconst router =  Router();\r\n\trouter.route('/')\r\n\t\t.post((req, res, next) => {\r\n\t\t\tSession.create(req.body)\r\n\t\t\t\t.then(user => {\r\n\t\t\t\t\tif (user) {\r\n\t\t\t\t\t\treq.session.cookie.expires = new Date(Date.now() + maxAge);\r\n\t\t\t\t\t\treq.session.user = user;\r\n\t\t\t\t\t\tres.json({ce: 233, da: user});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tres.json({ce: 300});\r\n\t\t\t\t});\r\n\t\t})\r\n\t\t.get((req, res, next) => {\r\n\t\t\tif (req.session.user) {\r\n\t\t\t\treq.session.cookie.expires = new Date(Date.now() + maxAge);\r\n\t\t\t\tres.json({ce: 233, da: req.session.user});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tres.json({ce: 300});\r\n\t\t})\r\n\t\t.delete((req, res, next) => {\r\n\t\t\tif (req.session.user) {\r\n\t\t\t\tstore.destroy(req.sessionID, () => res.json({ce: 233}));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tres.json({ce: 300});\r\n\t\t});\r\n\treturn router;\r\n};"]}