{"version":3,"sources":["../../src/router/posts.js"],"names":["module","exports","Router","Rest","Post","rest","res","result","json","router","all","req","next","method","session","user","send","ce","route","get","gets","skip","query","sp","limit","lt","sort","time","da","docs","map","doc","error","e","post","body","delete","deletes","fail","id","params","put","update"],"mappings":"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","file":"posts.js","sourcesContent":["module.exports = function ({Router, Rest, Post,}) {\r\n    const rest = new Rest('posts', (res, result) => res.json(result));\r\n    const router = Router();\r\n    router.all('*', (req, res, next) => {\r\n        if (req.method === 'GET' || req.session.user)return next();\r\n        else res.send({ce: 311});\r\n    });\r\n    router.route('/')\r\n        .get((req, res, next) => {\r\n            rest.gets({\r\n                res,\r\n                skip: req.query.sp,\r\n                limit: req.query.lt,\r\n                sort: {time: -1},\r\n                result: docs => {\r\n                    return {ce: 233, da: docs.map(doc => new Post(doc))};\r\n                },\r\n                error: (e) => {\r\n                    return {ce: 400, e};\r\n                },\r\n            });\r\n        })\r\n        .post((req, res, next) => {\r\n            rest.post({\r\n                res,\r\n                doc: new Post(req.body),\r\n                result: () => {\r\n                    return {ce: 233};\r\n                },\r\n                error: (e) => {\r\n                    return {ce: 400, e};\r\n                },\r\n            });\r\n        })\r\n        .delete((req, res, next) => {\r\n            rest.deletes({\r\n                res,\r\n                query: {},\r\n                result: () => {\r\n                    return {ce: 233};\r\n                },\r\n                fail: () => {\r\n                    return {ce: 300};\r\n                },\r\n                error: () => {\r\n                    return {ce: 400};\r\n                },\r\n            });\r\n        });\r\n    router.route('/:id')\r\n        .get((req, res, next) => {\r\n            rest.get({\r\n                res,\r\n                id: req.params.id,\r\n                result: doc => {\r\n                    return {ce: 233, da: new Post(doc)};\r\n                },\r\n                fail: () => {\r\n                    return {ce: 300};\r\n                },\r\n                error: () => {\r\n                    return {ce: 400};\r\n                },\r\n            });\r\n        })\r\n        .put((req, res, next) => {\r\n            rest.put({\r\n                res,\r\n                id: req.params.id,\r\n                update: req.body,\r\n                result: () => {\r\n                    return {ce: 233,};\r\n                },\r\n                fail: () => {\r\n                    return {ce: 300};\r\n                },\r\n                error: () => {\r\n                    return {ce: 400};\r\n                },\r\n            })\r\n        })\r\n        .delete((req, res, next) => {\r\n            rest.delete({\r\n                res,\r\n                id: req.params.id,\r\n                result: () => {\r\n                    return {ce: 233};\r\n                },\r\n                fail: () => {\r\n                    return {ce: 300};\r\n                },\r\n                error: () => {\r\n                    return {ce: 400};\r\n                },\r\n            });\r\n        });\r\n    return router;\r\n};"]}